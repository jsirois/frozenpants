name: CI

on: [push]

jobs:
  build_ubuntu18:
    runs-on: ubuntu-18.04
    steps:
    - uses: actions/checkout@v2
    - name: builds pex under ubuntu
      run: |
        ./build_pex.sh
        unzip -p pants.pex PEX-INFO | python -m json.tool

  build_macos10:
    runs-on: macos-10.15
    steps:
    - uses: actions/checkout@v2
    - name: builds pex under macos 10.15 (Catalina)
      run: |
        ./pyenv.sh 3.8.7
        PYTHON_PATH=.deps/pyenv/versions/3.8.7/bin/python3 ./build_pex.sh
        unzip -p pants.pex PEX-INFO | python -m json.tool
